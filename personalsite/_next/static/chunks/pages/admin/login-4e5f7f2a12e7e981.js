(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[567],{644:(e,o,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/login",function(){return n(3938)}])},3938:(e,o,n)=>{"use strict";n.r(o),n.d(o,{default:()=>d});var i=n(7876),t=n(4232),a=n(9099),r=n(1816),s=n(870),l=n(3611),c=n(5176);function d(){let[e,o]=(0,t.useState)(!1),[n,d]=(0,t.useState)(""),[u,g]=(0,t.useState)(!1),[m,f]=(0,t.useState)(!1),[h,w]=(0,t.useState)(!1),[b,p]=(0,t.useState)(""),v=(0,a.useRouter)(),{t:y}=(0,c.Bd)(),{user:x,signIn:E,loading:N}=(0,s.As)(),C=(0,l.DT)();console.log("=== ADMIN LOGIN PAGE LOADED ==="),console.log("Current environment:","production"),console.log("Base path from getBasePath():",(0,l.DT)()),console.log("Window runtime config available:",!!window.runtimeConfig),console.log("Runtime config content:",window.runtimeConfig),(0,t.useEffect)(()=>{(async()=>{try{p(y("admin.checkingFirebase","Checking Firebase initialization...")),await l.TY,await (0,l.ap)()?(console.log("Firebase initialized successfully"),w(!0)):(console.error("Firebase failed to initialize"),d(y("admin.firebaseError","Firebase initialization failed. Please try again."))),p("")}catch(e){console.error("Error checking Firebase initialization:",e),d(y("admin.firebaseError","Firebase initialization failed. Please try again.")),p("")}})()},[y]);let A=async e=>{var n,i,t,a,r,s,c;if(e.preventDefault(),o(!0),d(""),p(""),!h){console.error("Firebase is not initialized. Cannot proceed with login."),d(y("admin.firebaseNotReady","Authentication service is not ready. Please refresh the page and try again.")),o(!1);return}console.log("=== LOGIN FORM SUBMITTED ==="),console.log("Form submission timestamp:",new Date().toISOString());try{console.log("RUNTIME CONFIG CHECK:",{windowExists:!0,runtimeConfigExists:!!window.runtimeConfig,runtimeConfigContent:JSON.stringify(window.runtimeConfig),documentReadyState:"undefined"!=typeof document?document.readyState:"document not available"}),console.log("Starting authentication process");let o=e.currentTarget,s=(null===(n=o.elements.namedItem("email"))||void 0===n?void 0:n.value)||"",c=(null===(i=o.elements.namedItem("password"))||void 0===i?void 0:i.value)||"";if(!s||!c)throw console.error("Form values missing - email or password is empty"),Error("Please provide both email and password");let d=c.length;console.log("Credentials received, attempting to sign in"),console.log("Email being used:",s),console.log("Password length:",d),console.log("Firebase config loaded:",(null===(t=window.runtimeConfig)||void 0===t?void 0:t.firebase)?"Yes":"No"),console.log("Environment info:",{nodeEnv:"production",basePath:(0,l.DT)(),isProduction:!0,windowLocation:window.location.href,timeOfRequest:new Date().toISOString()}),console.log("Runtime config state:",{configExists:!!window.runtimeConfig,firebaseConfigExists:window.runtimeConfig&&!!window.runtimeConfig.firebase,firebaseApiKeyExists:window.runtimeConfig&&window.runtimeConfig.firebase&&!!window.runtimeConfig.firebase.apiKey,basePath:null===(a=window.runtimeConfig)||void 0===a?void 0:a.basePath,isProduction:null===(r=window.runtimeConfig)||void 0===r?void 0:r.isProduction}),console.log("Calling signIn method from useAuth hook");let u=await E(s,c);console.log("Authentication returned result:",!!u),console.log("User state after login:",!!x),console.log("Form values check:",{emailStillAvailable:s==s,passwordLengthStillMatches:d===c.length,userIsSet:!!x}),g(!0),p(y("admin.authSuccess","Authentication successful, redirecting..."));let m=(0,l.DT)();console.log("Auth completed, redirecting to ".concat(m,"/admin"));try{v.replace("".concat(m,"/admin"))}catch(e){console.error("Failed to redirect via router:",e)}console.log("Authentication successful, waiting for redirect")}catch(e){if(console.error("=== AUTHENTICATION ERROR ==="),console.error("Error occurred at:",new Date().toISOString()),e instanceof Error){console.error("Error name:",e.name),console.error("Error message:",e.message),console.error("Error stack:",e.stack);let o=e.message||"Unknown error";o.includes("auth/wrong-password")||o.includes("auth/user-not-found")?d(y("admin.invalidCredentials","Invalid email or password")):o.includes("auth/too-many-requests")?d(y("admin.tooManyRequests","Too many failed login attempts. Please try again later.")):o.includes("auth/network-request-failed")?d(y("admin.networkError","Network error. Please check your connection and try again.")):o.includes("auth/invalid-email")?d(y("admin.invalidEmail","Invalid email format.")):o.includes("auth/user-disabled")?d(y("admin.userDisabled","This account has been disabled. Please contact support.")):o.includes("auth/popup-closed-by-user")||o.includes("auth/cancelled-popup-request")?d(y("admin.authCancelled","Authentication was cancelled. Please try again.")):d("".concat(y("admin.loginFailed","Login failed"),": ").concat(o))}else{let o=String(e)||"Unknown error";console.error("Non-Error type error:",o),d("".concat(y("admin.loginFailed","Login failed"),": ").concat(o))}window.firebase?console.log("Current Firebase auth state:",null===(s=(c=window.firebase).auth)||void 0===s?void 0:s.call(c)):console.log("Firebase not available on window object")}finally{o(!1),console.log("Authentication attempt completed, loading state reset")}},S=e=>{try{console.log("Redirecting to ".concat(e,"...")),f(!0),v.replace(e)}catch(e){console.error("Redirect error:",e),d(y("admin.redirectError","Failed to redirect. Please navigate manually.")),f(!1)}};return(0,t.useEffect)(()=>()=>{},[]),(0,t.useEffect)(()=>{if(console.log("=== AUTH STATE CHANGED ==="),console.log("User authenticated:",!!x),console.log("Auth loading state:",N),console.log("Auth complete state:",u),console.log("Redirect in progress:",m),m){console.log("Redirect already in progress, ignoring state change");return}if(!x||N||m||!u&&e)N||e||console.log("Not authenticated yet, showing login form");else{console.log("Authenticated user detected, preparing to redirect");let e=(0,l.DT)();console.log("Using base path for redirect:",e),console.log("Full redirect URL:","".concat(e,"/admin/books")),S("".concat(e,"/admin/books"))}},[x,N,u,e,m,v]),console.log("Rendering AdminLoginPage component",{isLoading:e,hasError:!!n,isAuthLoading:N,isAuthenticated:!!x}),(0,t.useEffect)(()=>{},[x,N,u,m,C]),(0,i.jsx)(r.A,{section:"admin",children:(0,i.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-accent mb-8 text-center",children:y("admin.login","Admin Login")}),(0,i.jsxs)("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow p-8",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-accent mb-6",children:y("admin.login","Admin Login")}),n&&(0,i.jsx)("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:n}),b&&(0,i.jsx)("div",{className:"bg-yellow-100 text-yellow-700 p-3 rounded mb-4",children:b}),(N||m)&&(0,i.jsx)("div",{className:"bg-blue-100 text-blue-700 p-3 rounded mb-4",children:m?y("admin.redirecting","Authentication successful, redirecting..."):y("admin.checkingAuth","Checking authentication status...")}),!h&&!n&&(0,i.jsx)("div",{className:"bg-yellow-100 text-yellow-700 p-3 rounded mb-4",children:y("admin.initializingFirebase","Initializing authentication service...")}),(0,i.jsxs)("form",{onSubmit:A,children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:y("admin.email","Email")}),(0,i.jsx)("input",{id:"email",type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-steel-blue focus:border-steel-blue",required:!0})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:y("admin.password","Password")}),(0,i.jsx)("input",{id:"password",type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-steel-blue focus:border-steel-blue",required:!0})]}),(0,i.jsx)("button",{type:"submit",disabled:e||!h||N||m,className:"\n                w-full bg-steel-blue hover:bg-accent text-white font-medium py-2 px-4 rounded\n                transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-steel-blue\n                ".concat(e||!h||N||m?"opacity-70 cursor-not-allowed":"","\n              "),children:e?y("admin.signingIn","Signing in..."):y("admin.signIn","Sign In")})]})]})]})})}}},e=>{var o=o=>e(e.s=o);e.O(0,[593,223,299,137,789,636,792],()=>o(644)),_N_E=e.O()}]);