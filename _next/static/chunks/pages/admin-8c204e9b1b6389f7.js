(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{1565:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return n(8014)}])},7746:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var o=n(7876),a=n(4232),s=n(1660),r=n(5176);function l(e){var t,n;let{existingBook:l,onSuccess:i}=e,[d,c]=(0,a.useState)((null==l?void 0:l.isbn)||""),[u,m]=(0,a.useState)((null==l?void 0:l.status)||"toRead"),[g,b]=(0,a.useState)((null==l?void 0:l.notes)||""),[x,h]=(0,a.useState)(l||null),[f,p]=(0,a.useState)(!1),[v,y]=(0,a.useState)(""),[j,k]=(0,a.useState)(""),{t:N}=(0,r.Bd)(),w=async()=>{if(!d){y("Please enter an ISBN");return}p(!0),y("");try{let e=await (0,s.xj)(d);e?h(e):y("Book not found. Please check the ISBN and try again.")}catch(e){console.error("Error looking up book:",e),y("Error looking up book. Please try again.")}finally{p(!1)}},R=async()=>{if(!x){y("Please look up a book first");return}p(!0),y("");try{let e={...x,...void 0!==x.averageRating?{}:{averageRating:null},status:u,notes:g,dateAdded:new Date().toISOString()};if(void 0!==e.averageRating){let t=Number(e.averageRating);if(isNaN(t))throw Error("Rating must be a valid number");t<0||t>5?(console.warn("Rating outside normal range: ".concat(t,", adjusting to limit")),e.averageRating=Math.max(0,Math.min(5,t))):e.averageRating=t}else e.averageRating=void 0;console.log("Formatted book data:",e),await (0,s.bp)(e),k("Book added successfully!"),c(""),m("toRead"),b(""),h(null),i&&i()}catch(e){console.error("Error adding book:",e),y("Error adding book: ".concat(e instanceof Error?e.message:"Please try again."))}finally{p(!1)}},E=async()=>{if(!l){y("No book to update");return}p(!0),y("");try{await (0,s.r3)(l.id,{status:u,notes:g}),k("Book updated successfully!"),i&&i()}catch(e){console.error("Error updating book:",e),y("Error updating book. Please try again.")}finally{p(!1)}},S=async()=>{if(l&&confirm("Are you sure you want to delete this book?")){p(!0),y("");try{await (0,s.HA)(l.id),k("Book deleted successfully!"),i&&i()}catch(e){console.error("Error deleting book:",e),y("Error deleting book. Please try again.")}finally{p(!1)}}};return(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-accent mb-6",children:N("admin.bookManagement",l?"Edit Book":"Add New Book")}),v&&(0,o.jsx)("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:v}),j&&(0,o.jsx)("div",{className:"bg-green-100 text-green-700 p-3 rounded mb-4",children:j}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:N("admin.isbn","ISBN:")}),(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),disabled:!!l,className:"\n              flex-grow px-3 py-2 border border-gray-300 rounded-l-md \n              focus:outline-none focus:ring-steel-blue focus:border-steel-blue\n              ".concat(l?"bg-gray-100":"","\n            "),placeholder:"Enter ISBN"}),!l&&(0,o.jsx)("button",{type:"button",onClick:w,disabled:f||!d,className:"\n                bg-steel-blue hover:bg-accent text-white font-medium py-2 px-4 rounded-r-md\n                transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-steel-blue\n                ".concat(f||!d?"opacity-70 cursor-not-allowed":"","\n              "),children:f?"Loading...":N("admin.lookup","Lookup")})]})]}),x&&(0,o.jsx)("div",{className:"mb-6 p-4 bg-light-accent rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-start",children:[(null===(t=x.imageLinks)||void 0===t?void 0:t.thumbnail)&&(0,o.jsx)("img",{src:x.imageLinks.thumbnail,alt:"Cover of ".concat(x.title),className:"w-20 h-auto mr-4"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"font-bold text-lg",children:x.title}),(0,o.jsx)("p",{className:"text-sm",children:null===(n=x.authors)||void 0===n?void 0:n.join(", ")}),x.categories&&(0,o.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:x.categories.join(", ")})]})]})}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:N("admin.status","Reading Status:")}),(0,o.jsxs)("select",{id:"status",value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-steel-blue focus:border-steel-blue",children:[(0,o.jsx)("option",{value:"read",children:N("books.read","Read")}),(0,o.jsx)("option",{value:"reading",children:N("books.reading","Currently Reading")}),(0,o.jsx)("option",{value:"toRead",children:N("books.toRead","Want to Read")})]})]}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:N("admin.notes","Your Notes:")}),(0,o.jsx)("textarea",{id:"notes",value:g,onChange:e=>b(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-steel-blue focus:border-steel-blue",placeholder:"Your thoughts about this book..."})]}),(0,o.jsx)("div",{className:"flex justify-between",children:l?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{type:"button",onClick:E,disabled:f,className:"\n                bg-steel-blue hover:bg-accent text-white font-medium py-2 px-4 rounded\n                transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-steel-blue\n                ".concat(f?"opacity-70 cursor-not-allowed":"","\n              "),children:f?"Saving...":N("admin.update","Update Book")}),(0,o.jsx)("button",{type:"button",onClick:S,disabled:f,className:"\n                bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded\n                transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-600\n                ".concat(f?"opacity-70 cursor-not-allowed":"","\n              "),children:f?"Deleting...":N("admin.delete","Delete Book")})]}):(0,o.jsx)("button",{type:"button",onClick:R,disabled:f||!x,className:"\n              bg-steel-blue hover:bg-accent text-white font-medium py-2 px-4 rounded\n              transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-steel-blue\n              ".concat(f||!x?"opacity-70 cursor-not-allowed":"","\n            "),children:f?"Adding...":N("admin.add","Add to Collection")})})]})}},7964:(e,t,n)=>{"use strict";n.d(t,{J:()=>o});let o="/personalsite"},8014:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var o=n(7876),a=n(4232),s=n(9099),r=n(1816),l=n(870);function i(e){let{message:t="Loading..."}=e;return(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center p-8",children:[(0,o.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-steel-blue border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"}),(0,o.jsx)("p",{className:"mt-4 text-gray-600",children:t})]})}var d=n(7964);function c(e){let{children:t}=e,{user:n,loading:r}=(0,l.A)(),c=(0,s.useRouter)();return((0,a.useEffect)(()=>{r||n||c.replace("".concat(d.J,"/admin/login"))},[n,r,c]),r)?(0,o.jsx)(i,{message:"Checking authentication..."}):n?(0,o.jsx)(o.Fragment,{children:t}):null}var u=n(7746),m=n(5176);function g(){let e=(0,s.useRouter)(),{signOut:t}=(0,l.A)(),{t:n}=(0,m.Bd)(),[i,g]=(0,a.useState)(!1),b=async()=>{await t(),e.push("".concat(d.J,"/"))};return(0,o.jsx)(c,{children:(0,o.jsx)(r.A,{section:"admin",children:(0,o.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-accent",children:n("admin.bookManagement","Book Management")}),(0,o.jsx)("button",{onClick:b,className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded transition-colors",children:n("admin.signOut","Sign Out")})]}),i&&(0,o.jsx)("div",{className:"bg-green-100 text-green-700 p-3 rounded mb-4",children:n("admin.success","Operation completed successfully!")}),(0,o.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,o.jsx)(u.A,{onSuccess:()=>{g(!0),setTimeout(()=>g(!1),3e3)}})})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[25,974,636,593,792],()=>t(1565)),_N_E=e.O()}]);